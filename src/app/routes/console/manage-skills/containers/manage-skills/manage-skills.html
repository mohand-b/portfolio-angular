<div class="flex flex-col h-full">
  <div
    class="flex items-center justify-between min-h-[5rem] px-[1.25rem] border-b border-neutral-200 bg-white"
  >
    <h1 class="text-2xl font-semibold text-neutral-800">Compétences</h1>

    <button (click)="openPanel()" class="secondary" matButton="filled">
      <mat-icon>add</mat-icon>
      Ajouter une compétence
    </button>
  </div>

  <div
    class="flex-1 grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-[1.5rem] bg-neutral-100 p-[1.25rem] shadow-inner"
    style="--tw-shadow-color: rgba(0,0,0,0.05);"
  >
    @for (cat of categories; track cat) {
      <app-skill-category-section
        cdkDropList
        cdkDropListSortingDisabled
        [cdkDropListData]="getSkillsByCategory(cat)"
        [cdkDropListConnectedTo]="dropListIds"
        [id]="cat"
        (cdkDropListDropped)="drop($event, cat)"
        [category]="cat"
      >
        @for (skill of getSkillsByCategory(cat); track skill.id) {
          <app-skill-item
            cdkDrag
            [skill]="skill"
            [cdkDragData]="skill"
            (setLevel)="onSkillLevelChange(skill, $event)"
            (cdkDragStarted)="isDragging.set(true)"
            (cdkDragEnded)="isDragging.set(false)"
          />
        }
      </app-skill-category-section>
    }
  </div>
</div>


<div
  (cdkDropListDropped)="onDropToTrash($event)"
  [cdkDropListConnectedTo]="dropListIds"
  [cdkDropListData]="emptySkillList"
  [class.global-trash-zone--active]="isDragging()"
  [id]="dropTrashId"
  cdkDropList
  class="global-trash-zone"
>
  <mat-icon style="color: #e53935;">delete</mat-icon>
</div>


<app-side-panel
  (closed)="onCloseRequested()"
  [isOpen]="panelOpen()"
>
  <app-skill-create (created)="onCloseRequested()"/>
</app-side-panel>
